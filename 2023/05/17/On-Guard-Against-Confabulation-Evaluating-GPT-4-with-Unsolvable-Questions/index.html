<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-PX7ZFRZ');
    </script>
    <!-- End Google Tag Manager -->
    <meta name="google-site-verification" content="2DpaLx8Rps-fAN3L9ucZEyUbmfKyvH1niUC9D1giaRc" />
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="Introduction:In today’s rapidly evolving technological landscape, Large Language Models (LLMs) such as GPT-4 are becoming increasingly sophisticated. "/>
    

    <!--Author-->
    
        <meta name="author" content="Lucas Klaassen"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Testing Experiment Reveals GPT-4&#39;s 46% Accuracy in Detecting Unsolvable Questions"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Introduction:In today’s rapidly evolving technological landscape, Large Language Models (LLMs) such as GPT-4 are becoming increasingly sophisticated. "/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="Lucas Klaassen"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://www.lucasklaassen.comimg/home-bg.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://www.lucasklaassen.comimg/home-bg.jpg"/>
    

    <!-- Title -->
    
    <title>Testing Experiment Reveals GPT-4&#39;s 46% Accuracy in Detecting Unsolvable Questions - Lucas Klaassen</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

<meta name="generator" content="Hexo 6.3.0"></head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Lucas Klaassen</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener" href="https://github.com/lucasklaassen">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Testing Experiment Reveals GPT-4's 46% Accuracy in Detecting Unsolvable Questions</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2023-05-17
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction:"></a>Introduction:</h2><p>In today’s rapidly evolving technological landscape, Large Language Models (LLMs) such as GPT-4 are becoming increasingly sophisticated. However, these models are not without their limitations, one of the main ones being confabulation, where the model generates information that might not be factual or accurate. To combat this, we utilized the OpenAI Evals framework, a tool designed for systematically testing and improving the performance of LLMs. In this post, we will guide you through our process of creating an evaluation that focuses on unsolvable questions alongside contextual information, aimed at reducing confabulation in GPT-4.</p>
<h2 id="1-Defining-Confabulation-and-Unsolvable-Questions"><a href="#1-Defining-Confabulation-and-Unsolvable-Questions" class="headerlink" title="1. Defining Confabulation and Unsolvable Questions:"></a>1. Defining Confabulation and Unsolvable Questions:</h2><p>Confabulation refers to the generation of information by the language model that might not be factual or substantiated. Our primary objective with the “Unsolvable Questions Evaluation” was to assess GPT-4’s capability in discerning and responding aptly to these unsolvable questions alongside contextual information, thereby highlighting its tendencies to confabulate. As more people build contextual integrations with GPT, it will be important that GPT can deal with answering questions truthfully alongside context.</p>
<h2 id="2-Harnessing-the-Power-of-OpenAI-Evals"><a href="#2-Harnessing-the-Power-of-OpenAI-Evals" class="headerlink" title="2. Harnessing the Power of OpenAI Evals:"></a>2. Harnessing the Power of OpenAI Evals:</h2><p>In order to effectively assess GPT-4’s performance, we utilized the <a target="_blank" rel="noopener" href="https://github.com/openai/evals">OpenAI Evals</a> framework. This tool facilitated a structured approach to our evaluation process, ensuring we targeted and measured key performance indicators in a systematic way.</p>
<h2 id="3-Building-the-Dataset"><a href="#3-Building-the-Dataset" class="headerlink" title="3. Building the Dataset:"></a>3. Building the Dataset:</h2><p>The dataset used for our evaluation was a modified version of the Stanford Question Answering Dataset (SQuAD), a collection of over 150,000 crowd-sourced questions based on Wikipedia articles. Our focus was on the SQuAD2.0 dataset, which includes over 50,000 unsolvable questions. In order to adapt this dataset for our purposes, we reformatted it into a chat format that GPT-4 could understand, concentrating on 318 samples containing unsolvable questions.</p>
<p>This section will detail the technical process of how we extracted a unique set of questions from the larger SQuAD2.0 dataset. We’ll provide a walkthrough of the Node.js script used to parse through the dataset and curate our subset of examples.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* SQuAD2.0 data converter</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">BEFORE PROCEEDING: Download train.json from the official repo:</span></span><br><span class="line"><span class="comment">https://rajpurkar.github.io/SQuAD-explorer/dataset/train-v2.0.json</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Download the file, rename it to train.json, and put it in this folder, and you are ready to go. :)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Transform</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;stream&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> inputFile = fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;train.json&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> outputFile = fs.<span class="title function_">createWriteStream</span>(<span class="string">&quot;samples.jsonl&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>In this initial part of the script, we’re loading the <code>fs</code> (file system) and <code>stream</code> modules from Node.js. We then read the input file (<code>train.json</code>) and prepare an output file stream (<code>samples.jsonl</code>) for writing.</p>
<p>The next chunk of code is our <code>Transform</code> stream, which is used to parse and reformat each line of the input data:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> processLine = <span class="keyword">new</span> <span class="title class_">Transform</span>(&#123;</span><br><span class="line">  <span class="attr">objectMode</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="title function_">transform</span>(<span class="params">line, _, done</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!line) <span class="keyword">return</span> <span class="title function_">done</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> obj;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(line);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">done</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Failed to parse JSON: <span class="subst">$&#123;err.message&#125;</span>`</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">indexToAnswer</span> = (<span class="params">bool</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Unsolveable&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;Solveable&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> transformedObj = &#123;</span><br><span class="line">      <span class="attr">input</span>: [</span><br><span class="line">        &#123; <span class="attr">role</span>: <span class="string">&quot;system&quot;</span>, <span class="attr">content</span>: <span class="string">&#x27;You are UnsolvableGPT. You will be provided a question and some context for the question. Using only the context to answer the question determine if it is &quot;Solveable&quot; or &quot;Unsolveable&quot;. Respond with only one word without punctuation, either: &quot;Solveable&quot;: The submitted question is solvable with the context provided alongside it and no other outside information OR &quot;Unsolveable&quot;: The submitted question is unsolvable with the context provided alongside it. There is not enough context to answer the question. Remember, only answer with &quot;Solveable&quot; OR &quot;Unsolveable&quot;, do not include anything else.&#x27;</span>&#125;,</span><br><span class="line">        &#123; <span class="attr">role</span>: <span class="string">&quot;user&quot;</span>, <span class="attr">content</span>: <span class="string">`Question: <span class="subst">$&#123;obj[<span class="string">&quot;question&quot;</span>]&#125;</span>\n Context: <span class="subst">$&#123;obj[<span class="string">&quot;context&quot;</span>]&#125;</span>`</span> &#125;</span><br><span class="line">      ], <span class="attr">ideal</span>: <span class="title function_">indexToAnswer</span>(obj[<span class="string">&quot;is_impossible&quot;</span>]),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">push</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(transformedObj) + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="title function_">done</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The <code>transform</code> function parses each line into JSON and checks for the question’s solvability. It then formats this information into a new JSON object that’s suitable for our chat model.</p>
<p>Finally, we parse the entire input file, iterate over the contents, and selectively write the questions we’re interested in to our output file:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> parsedFile = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(inputFile);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(parsedFile);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; parsedFile.<span class="property">data</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> currentDocument = parsedFile.<span class="property">data</span>[i];</span><br><span class="line">  currentDocument.<span class="property">paragraphs</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">paragraph</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> context = paragraph.<span class="property">context</span>;</span><br><span class="line">    <span class="comment">// Generate a diverse training set by picking only 2 questions from each topic</span></span><br><span class="line">    <span class="comment">// Ensure an equal balance of unsolvable and solvable questions</span></span><br><span class="line">    <span class="comment">// Randomly select questions</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (context.<span class="property">length</span> &gt; <span class="number">1500</span> || context.<span class="property">length</span> &lt; <span class="number">500</span> || <span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.98</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> possibleToAnswer = paragraph.<span class="property">qas</span>.<span class="title function_">find</span>(<span class="function"><span class="params">qa</span> =&gt;</span> !<span class="title class_">Boolean</span>(qa.<span class="property">is_impossible</span>));</span><br><span class="line">    <span class="keyword">const</span> impossibleToAnswer = paragraph.<span class="property">qas</span>.<span class="title function_">find</span>(<span class="function"><span class="params">qa</span> =&gt;</span> <span class="title class_">Boolean</span>(qa.<span class="property">is_impossible</span>));</span><br><span class="line">    <span class="keyword">if</span>(possibleToAnswer &amp;&amp; impossibleToAnswer) &#123;</span><br><span class="line">      possibleToAnswer.<span class="property">context</span> = context;</span><br><span class="line">      impossibleToAnswer.<span class="property">context</span> = context;</span><br><span class="line">      processLine.<span class="title function_">write</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(possibleToAnswer) + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      processLine.<span class="title function_">write</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(impossibleToAnswer) + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">processLine.<span class="title function_">pipe</span>(outputFile);</span><br><span class="line">outputFile.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error: <span class="subst">$&#123;err.message&#125;</span>`</span>)).<span class="title function_">on</span>(<span class="string">&quot;finish&quot;</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Output file created successfully.&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>The loop traverses each document, paragraph by paragraph, with a focus on creating a balanced and diverse set of questions for the model. We are only considering context lengths between 500 and 1500 characters to ensure manageability. We also impose a randomness factor to promote diversity in the final selection. For each paragraph that meets these criteria, we look for one solvable and one unsolvable question, if available. We then write both to our output file, thereby creating a balanced subset of solvable and unsolvable questions.</p>
<h2 id="4-Conducting-the-Evaluation-and-Highlighting-Failures"><a href="#4-Conducting-the-Evaluation-and-Highlighting-Failures" class="headerlink" title="4. Conducting the Evaluation and Highlighting Failures:"></a>4. Conducting the Evaluation and Highlighting Failures:</h2><p>After preparing the dataset, we ran the evaluation using GPT-3.5, for efficiency and cost-effectiveness. Through this process, we were able to document instances where the model was unable to provide accurate answers.</p>
<p>Taking these failure logs, we devised a new script that parses these logs, identifies instances where the model could not deliver the right answers, and isolates them into a separate file. This method enabled us to run the script multiple times, resulting in a larger dataset that also illustrated a broader range of failure cases with which the model struggled.</p>
<p>Here’s the script that accomplishes this task:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  Grab the file from the last run: /tmp/evallogs/&lt;idxxx_gpt-3.5-turbo_impossible_detector&gt;.jsonl</span></span><br><span class="line"><span class="comment">  Rename it to run.jsonl and put it in a folder called logs/ within this folder.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Run this file and the failures will be outputted to a file named failure-samples.jsonl</span></span><br><span class="line"><span class="comment">  You can now keep these examples and combine them with other runs to get a good sample set that GPT struggles with</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> readline = <span class="built_in">require</span>(<span class="string">&quot;readline&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Transform</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;stream&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> inputFile = fs.<span class="title function_">createReadStream</span>(<span class="string">&quot;logs/run.jsonl&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> outputFile = fs.<span class="title function_">createWriteStream</span>(<span class="string">&quot;failure-samples.jsonl&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>The script begins by importing the required modules and setting up the streams for the input and output files. </p>
<p>Then we create a <code>Transform</code> stream, similar to the one in <code>convert.js</code>, which essentially copies each line from the input file to the output file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> processLine = <span class="keyword">new</span> <span class="title class_">Transform</span>(&#123;</span><br><span class="line">  <span class="attr">objectMode</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="title function_">transform</span>(<span class="params">line, _, done</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!line) <span class="keyword">return</span> <span class="title function_">done</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> obj;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      obj = line;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">done</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Failed to parse JSON: <span class="subst">$&#123;err.message&#125;</span>`</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> transformedObj = obj;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">push</span>(transformedObj + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="title function_">done</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Next, we create a function <code>parseLines</code> that identifies and processes the failures from the log. The function looks for the ‘match’ lines where <code>correct</code> is false (meaning the model got the answer wrong), and pairs each one with its preceding ‘prompt’ line to preserve the context of the failed question. </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">parseLines</span> = (<span class="params">line, previousLine</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span>(line &amp;&amp; previousLine &amp;&amp; !<span class="title class_">JSON</span>.<span class="title function_">parse</span>(previousLine).<span class="property">spec</span> &amp;&amp; <span class="title class_">JSON</span>.<span class="title function_">parse</span>(line).<span class="property">type</span> === <span class="string">&quot;match&quot;</span> &amp;&amp; !<span class="title class_">JSON</span>.<span class="title function_">parse</span>(line).<span class="property">data</span>.<span class="property">correct</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> promptData = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(previousLine).<span class="property">data</span>;</span><br><span class="line">    <span class="keyword">let</span> newLine = &#123;&#125;;</span><br><span class="line">    newLine.<span class="property">input</span> = promptData.<span class="property">prompt</span>;</span><br><span class="line">    newLine.<span class="property">ideal</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(line).<span class="property">data</span>.<span class="property">expected</span>;</span><br><span class="line">    processLine.<span class="title function_">write</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(newLine));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Finally, we use Node’s <code>readline</code> interface to read the input file line by line, calling <code>parseLines</code> for each one. The results are piped to the output file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> lineLimit = <span class="number">1500</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rl = readline.<span class="title function_">createInterface</span>(&#123; <span class="attr">input</span>: inputFile, <span class="attr">crlfDelay</span>: <span class="title class_">Infinity</span> &#125;);</span><br><span class="line"><span class="keyword">let</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> previousLine;</span><br><span class="line">rl.<span class="title function_">on</span>(<span class="string">&quot;line&quot;</span>, <span class="function">(<span class="params">line</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(i &lt; lineLimit) &#123;</span><br><span class="line">    <span class="title function_">parseLines</span>(line, previousLine);</span><br><span class="line">    previousLine = line;</span><br><span class="line">    i++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">processLine.<span class="title function_">pipe</span>(outputFile);</span><br><span class="line">outputFile.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error: <span class="subst">$&#123;err.message&#125;</span>`</span>)).<span class="title function_">on</span>(<span class="string">&quot;finish&quot;</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Output file</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> created successfully.&quot;</span>));</span><br><span class="line">rl.<span class="title function_">on</span>(<span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123; processLine.<span class="title function_">end</span>(); &#125;);</span><br></pre></td></tr></table></figure>

<p>This script produces a file named <code>failure-samples.jsonl</code>, which contains all the failure cases from the logs. These examples can be further combined with others from additional runs to create a robust set of challenging samples for the model to improve upon.</p>
<h2 id="5-Understanding-the-Importance-of-the-Evaluation"><a href="#5-Understanding-the-Importance-of-the-Evaluation" class="headerlink" title="5. Understanding the Importance of the Evaluation:"></a>5. Understanding the Importance of the Evaluation:</h2><p>GPT-4, with its advanced capabilities, is shaping up to be a potent learning assistant. Evaluating its ability to discern solvable from unsolvable questions based on the provided context is crucial, especially as we develop more advanced applications atop this technology. This evaluation not only provides insights into potential shortcomings but also measures GPT-4’s capability to dodge trick questions.</p>
<p>As GPT-4 becomes accessible to individual developers and organizations, it is being deployed in more complex, context-based workflows. An evaluation like ours provides valuable insights and learnings, benefiting the wider community.</p>
<h2 id="6-Sharing-the-Results-of-the-Evaluation"><a href="#6-Sharing-the-Results-of-the-Evaluation" class="headerlink" title="6. Sharing the Results of the Evaluation:"></a>6. Sharing the Results of the Evaluation:</h2><p>Upon discovering questions that stumped GPT-3.5, we aimed to test GPT-4’s performance and submit the results for OpenAI to work on its enhancement. Our initial evaluation showed GPT-4 outperforming its predecessor, GPT-3.5, with an accuracy of 0.46 compared to 0.13.</p>
<p>Our “Unsolvable Questions Evaluation” highlighted GPT-4’s progress in discerning complex questions and its confabulation issue. Using OpenAI Evals, we gained crucial insights into enhancing large language models.</p>
<p>We look forward to OpenAI’s response to our experiment and contributing towards the evolution of robust AI systems. For a closer look at our evaluation and its updates, visit the open pull request. Together, let’s drive AI innovation responsibly.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/openai/evals/pull/981">Github Pull Request</a></p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/lucasklaassen" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2023 Lucas Klaassen<br></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>